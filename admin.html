<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸²æŸ“æ–‡åŒ– - ç®¡ç†åå°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #0a0a0a;
            --card: #111111;
            --text: #ffffff;
            --text-secondary: #888888;
            --accent: #d4a55c;
            --border: #222222;
            --input-bg: #1a1a1a;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* ç™»å½•é¡µ */
        .login-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: radial-gradient(ellipse at 20% 80%, rgba(212, 165, 92, 0.1) 0%, transparent 50%);
        }

        .login-box {
            width: 90%;
            max-width: 400px;
            padding: 3rem;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        .login-box h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .login-box p {
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .input-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 1rem;
            border-radius: 4px;
            font-family: inherit;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn {
            width: 100%;
            padding: 1rem;
            background: var(--accent);
            color: #000;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--accent);
            color: var(--accent);
        }

        .error-msg {
            color: #ff4444;
            font-size: 0.85rem;
            margin-top: 1rem;
            text-align: center;
            display: none;
        }

        /* ç®¡ç†ç•Œé¢ */
        .admin-panel {
            display: none;
            min-height: 100vh;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: var(--card);
            border-right: 1px solid var(--border);
            padding: 2rem 0;
        }

        .sidebar-header {
            padding: 0 1.5rem 2rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }

        .sidebar-header h2 {
            font-size: 1.2rem;
            color: var(--accent);
        }

        .sidebar-header p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.3rem;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-menu li {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            font-size: 0.9rem;
        }

        .nav-menu li:hover,
        .nav-menu li.active {
            background: rgba(212, 165, 92, 0.1);
            border-left-color: var(--accent);
            color: var(--accent);
        }

        .logout-btn {
            position: absolute;
            bottom: 2rem;
            left: 1.5rem;
            right: 1.5rem;
            padding: 0.8rem;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .logout-btn:hover {
            border-color: #ff4444;
            color: #ff4444;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            margin-left: 250px;
            padding: 2rem;
            min-height: 100vh;
        }

        .page-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .page-header h1 {
            font-size: 1.5rem;
            font-weight: 500;
        }

        /* å†…å®¹åŒºå— */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* è¡¨å•æ ·å¼ */
        .form-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 1.5rem;
        }

        .form-card h3 {
            font-size: 1rem;
            margin-bottom: 1.5rem;
            color: var(--accent);
            font-weight: 500;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 0.9rem;
            border-radius: 4px;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* ä½œå“åˆ—è¡¨ */
        .works-list {
            display: grid;
            gap: 1rem;
        }

        .work-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .work-thumb {
            width: 160px;
            height: 90px;
            background: var(--input-bg);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 0.8rem;
            overflow: hidden;
        }

        .work-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .work-info {
            flex: 1;
        }

        .work-info h4 {
            font-size: 1rem;
            margin-bottom: 0.3rem;
        }

        .work-info p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.3rem;
        }

        .work-info .work-link {
            font-size: 0.75rem;
            color: var(--accent);
            word-break: break-all;
        }

        .work-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }

        .btn-edit {
            background: var(--accent);
            color: #000;
        }

        .btn-delete {
            background: transparent;
            border: 1px solid #ff4444;
            color: #ff4444;
        }

        /* æ·»åŠ æŒ‰é’® */
        .add-btn {
            margin-bottom: 1.5rem;
            padding: 1rem 2rem;
            background: transparent;
            border: 2px dashed var(--border);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            width: 100%;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .add-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 1.1rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* å‘å¸ƒæŒ‰é’® */
        .publish-bar {
            position: fixed;
            bottom: 0;
            left: 250px;
            right: 0;
            padding: 1rem 2rem;
            background: var(--card);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .publish-bar p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .publish-bar .btn {
            width: auto;
            padding: 0.8rem 2rem;
        }

        /* æç¤ºæ¶ˆæ¯ */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--accent);
            color: #000;
            border-radius: 4px;
            font-size: 0.9rem;
            z-index: 10000;
            transform: translateX(150%);
            transition: transform 0.3s;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: #ff4444;
            color: #fff;
        }

        /* ä»£ç è¾“å‡º */
        .code-output {
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.75rem;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
            color: var(--text-secondary);
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
                z-index: 100;
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .work-card {
                flex-direction: column;
                align-items: flex-start;
            }

            .work-thumb {
                width: 100%;
                height: 160px;
            }

            .publish-bar {
                left: 0;
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <h1>æ¸²æŸ“æ–‡åŒ–</h1>
            <p>ç®¡ç†åå°</p>
            <div class="input-group">
                <label>å¯†ç </label>
                <input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç ">
            </div>
            <button class="btn" onclick="login()">ç™»å½•</button>
            <p class="error-msg" id="errorMsg">å¯†ç é”™è¯¯</p>
        </div>
    </div>

    <!-- ç®¡ç†ç•Œé¢ -->
    <div class="admin-panel" id="adminPanel">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>æ¸²æŸ“æ–‡åŒ–</h2>
                <p>ç½‘ç«™ç®¡ç†åå°</p>
            </div>
            <ul class="nav-menu">
                <li class="active" onclick="showSection('works')">ğŸ“ ä½œå“ç®¡ç†</li>
                <li onclick="showSection('info')">ğŸ¢ å…¬å¸ä¿¡æ¯</li>
                <li onclick="showSection('contact')">ğŸ“ è”ç³»æ–¹å¼</li>
                <li onclick="showSection('export')">ğŸš€ å‘å¸ƒç½‘ç«™</li>
            </ul>
            <button class="logout-btn" onclick="logout()">é€€å‡ºç™»å½•</button>
        </aside>

        <!-- ä¸»å†…å®¹ -->
        <main class="main-content">
            <!-- ä½œå“ç®¡ç† -->
            <section class="content-section active" id="section-works">
                <div class="page-header">
                    <h1>ä½œå“ç®¡ç†</h1>
                </div>
                
                <button class="add-btn" onclick="openModal('add')">+ æ·»åŠ æ–°ä½œå“</button>
                
                <div class="works-list" id="worksList">
                    <!-- ä½œå“åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </section>

            <!-- å…¬å¸ä¿¡æ¯ -->
            <section class="content-section" id="section-info">
                <div class="page-header">
                    <h1>å…¬å¸ä¿¡æ¯</h1>
                </div>
                
                <div class="form-card">
                    <h3>åŸºæœ¬ä¿¡æ¯</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>å…¬å¸åç§°</label>
                            <input type="text" id="companyName" value="æˆéƒ½æ¸²æŸ“æ–‡åŒ–ä¼ åª’æœ‰é™å…¬å¸">
                        </div>
                        <div class="form-group">
                            <label>å“ç‰Œå£å·</label>
                            <input type="text" id="companyTagline" value="ç”¨ç”µå½±è¯­è¨€è®²è¿°å“ç‰Œæ•…äº‹">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>å…¬å¸ç®€ä»‹</label>
                        <textarea id="companyDesc">æˆéƒ½æ¸²æŸ“æ–‡åŒ–ä¼ åª’æœ‰é™å…¬å¸ï¼Œæˆç«‹äº2019å¹´ï¼Œæ˜¯ä¸€å®¶ä¸“æ³¨äºå½±åƒåˆ›ä½œçš„ä¸“ä¸šå›¢é˜Ÿã€‚æˆ‘ä»¬æ·±è€•å¹¿å‘Šè§†é¢‘é¢†åŸŸï¼ŒæœåŠ¡å®¢æˆ·æ¶µç›–å›½é™…å¤§ç‰Œåˆ°åˆåˆ›ä¼ä¸šã€‚</textarea>
                    </div>
                </div>

                <div class="form-card">
                    <h3>æ•°æ®ç»Ÿè®¡</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>å¹´æ•°</label>
                            <input type="text" id="statYears" value="5+">
                        </div>
                        <div class="form-group">
                            <label>é¡¹ç›®æ•°</label>
                            <input type="text" id="statProjects" value="200+">
                        </div>
                        <div class="form-group">
                            <label>è·èµæ”¶è—</label>
                            <input type="text" id="statLikes" value="2.5ä¸‡+">
                        </div>
                    </div>
                </div>
            </section>

            <!-- è”ç³»æ–¹å¼ -->
            <section class="content-section" id="section-contact">
                <div class="page-header">
                    <h1>è”ç³»æ–¹å¼</h1>
                </div>
                
                <div class="form-card">
                    <h3>è”ç³»ä¿¡æ¯</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ç”µè¯</label>
                            <input type="text" id="contactPhone" value="185 8249 3173">
                        </div>
                        <div class="form-group">
                            <label>å¾®ä¿¡</label>
                            <input type="text" id="contactWechat" placeholder="ä½ çš„å¾®ä¿¡å·">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>é‚®ç®±</label>
                        <input type="email" id="contactEmail" placeholder="ä½ çš„é‚®ç®±">
                    </div>
                </div>
            </section>

            <!-- å‘å¸ƒç½‘ç«™ -->
            <section class="content-section" id="section-export">
                <div class="page-header">
                    <h1>å‘å¸ƒç½‘ç«™</h1>
                </div>
                
                <div class="form-card">
                    <h3>éƒ¨ç½²è¯´æ˜</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem; line-height: 1.8;">
                        ç‚¹å‡»"ç”Ÿæˆå¹¶å‘å¸ƒ"æŒ‰é’®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆæœ€æ–°çš„ç½‘ç«™ä»£ç å¹¶æ¨é€åˆ° GitHubã€‚<br>
                        Vercel ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ›´æ–°å¹¶é‡æ–°éƒ¨ç½²ç½‘ç«™ï¼ˆçº¦éœ€ 30-60 ç§’ï¼‰ã€‚
                    </p>
                    
                    <div class="form-group">
                        <label>GitHub Tokenï¼ˆç”¨äºè‡ªåŠ¨å‘å¸ƒï¼‰</label>
                        <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
                        <small style="color: var(--text-secondary); font-size: 0.75rem; display: block; margin-top: 0.5rem;">
                            è·å–æ–¹å¼ï¼šGitHub Settings â†’ Developer settings â†’ Personal access tokens â†’ Generate new token (classic) â†’ å‹¾é€‰ "repo" æƒé™
                        </small>
                    </div>
                    
                    <button class="btn" onclick="publishSite()" style="margin-top: 1rem;">
                        ğŸš€ ç”Ÿæˆå¹¶å‘å¸ƒ
                    </button>
                    
                    <div id="publishStatus" style="margin-top: 1.5rem; display: none;">
                        <label>å‘å¸ƒçŠ¶æ€</label>
                        <div class="code-output" id="publishLog"></div>
                    </div>
                </div>
            </section>

            <!-- å‘å¸ƒæ  -->
            <div class="publish-bar">
                <p>ğŸ’¡ ä¿®æ”¹å®Œæˆåï¼Œè®°å¾—ç‚¹å‡»"ç”Ÿæˆå¹¶å‘å¸ƒ"æ›´æ–°ç½‘ç«™</p>
                <button class="btn" onclick="showSection('export')">å»å‘å¸ƒ â†’</button>
            </div>
        </main>
    </div>

    <!-- æ·»åŠ /ç¼–è¾‘ä½œå“æ¨¡æ€æ¡† -->
    <div class="modal" id="workModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">æ·»åŠ ä½œå“</h3>
                <button class="modal-close" onclick="closeModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>ä½œå“æ ‡é¢˜</label>
                    <input type="text" id="workTitle" placeholder="ä¾‹å¦‚ï¼š361Â° å“ç‰Œ TVC">
                </div>
                <div class="form-group">
                    <label>ä½œå“æè¿°</label>
                    <input type="text" id="workDesc" placeholder="ç®€çŸ­æè¿°ï¼Œä¾‹å¦‚ï¼šè’é‡å¤§é•–å®¢é£æ ¼å¹¿å‘Šç‰‡">
                </div>
                <div class="form-group">
                    <label>Bç«™è§†é¢‘é“¾æ¥</label>
                    <input type="text" id="workVideoUrl" placeholder="https://b23.tv/xxxxx æˆ– BVå·">
                    <small style="color: var(--text-secondary); font-size: 0.75rem;">
                        æ”¯æŒ b23.tv çŸ­é“¾æ¥æˆ– BVå·ï¼ˆå¦‚ BV1Zf421i7zqï¼‰
                    </small>
                </div>
                <div class="form-group">
                    <label>å°é¢å›¾ç‰‡</label>
                    <input type="file" id="workImage" accept="image/*" onchange="previewImage(this)">
                    <div id="imagePreview" style="margin-top: 1rem; width: 160px; height: 90px; background: var(--input-bg); border-radius: 4px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); font-size: 0.8rem;">
                        é¢„è§ˆ
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary btn-small" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn-edit btn-small" onclick="saveWork()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- Toast æç¤º -->
    <div class="toast" id="toast"></div>

    <script>
        // æ•°æ®å­˜å‚¨
        let siteData = {
            works: [
                {
                    id: 1,
                    title: 'ã€æˆ‘ç”¨GH6æ‹äº†ä¸€éƒ¨è’é‡å¤§é•–å®¢ã€‘',
                    desc: '361Â° å“ç‰Œ TVC',
                    videoUrl: 'https://b23.tv/xi4SUa1',
                    bvid: 'BV1Zf421i7zq',
                    image: 'images/work-361.jpg'
                }
            ],
            company: {
                name: 'æˆéƒ½æ¸²æŸ“æ–‡åŒ–ä¼ åª’æœ‰é™å…¬å¸',
                tagline: 'ç”¨ç”µå½±è¯­è¨€è®²è¿°å“ç‰Œæ•…äº‹',
                description: 'æˆéƒ½æ¸²æŸ“æ–‡åŒ–ä¼ åª’æœ‰é™å…¬å¸ï¼Œæˆç«‹äº2019å¹´ï¼Œæ˜¯ä¸€å®¶ä¸“æ³¨äºå½±åƒåˆ›ä½œçš„ä¸“ä¸šå›¢é˜Ÿã€‚',
                stats: {
                    years: '5+',
                    projects: '200+',
                    likes: '2.5ä¸‡+'
                }
            },
            contact: {
                phone: '185 8249 3173',
                wechat: '',
                email: ''
            }
        };

        let editingWorkId = null;
        let tempImageData = null;

        // ç™»å½•
        function login() {
            const password = document.getElementById('password').value;
            // é»˜è®¤å¯†ç ï¼šxuanran2024
            if (password === 'xuanran2024') {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadWorks();
                showToast('ç™»å½•æˆåŠŸ');
            } else {
                document.getElementById('errorMsg').style.display = 'block';
            }
        }

        // é€€å‡º
        function logout() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('password').value = '';
            document.getElementById('errorMsg').style.display = 'none';
        }

        // åˆ‡æ¢é¡µé¢
        function showSection(section) {
            document.querySelectorAll('.nav-menu li').forEach(li => li.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById('section-' + section).classList.add('active');
        }

        // åŠ è½½ä½œå“åˆ—è¡¨
        function loadWorks() {
            const list = document.getElementById('worksList');
            list.innerHTML = siteData.works.map(work => `
                <div class="work-card">
                    <div class="work-thumb">
                        ${work.image ? `<img src="${work.image}" alt="${work.title}">` : '[æ— å°é¢]'}
                    </div>
                    <div class="work-info">
                        <h4>${work.title}</h4>
                        <p>${work.desc}</p>
                        <p class="work-link">${work.videoUrl}</p>
                    </div>
                    <div class="work-actions">
                        <button class="btn-small btn-edit" onclick="editWork(${work.id})">ç¼–è¾‘</button>
                        <button class="btn-small btn-delete" onclick="deleteWork(${work.id})">åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }

        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal(type) {
            document.getElementById('workModal').classList.add('active');
            document.getElementById('modalTitle').textContent = type === 'add' ? 'æ·»åŠ ä½œå“' : 'ç¼–è¾‘ä½œå“';
            
            if (type === 'add') {
                editingWorkId = null;
                document.getElementById('workTitle').value = '';
                document.getElementById('workDesc').value = '';
                document.getElementById('workVideoUrl').value = '';
                document.getElementById('imagePreview').innerHTML = 'é¢„è§ˆ';
                tempImageData = null;
            }
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            document.getElementById('workModal').classList.remove('active');
        }

        // é¢„è§ˆå›¾ç‰‡
        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    tempImageData = e.target.result;
                    document.getElementById('imagePreview').innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 100%; object-fit: cover;">`;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // æå–BVå·
        function extractBvid(url) {
            // æ”¯æŒ BVå·ã€b23.tvé“¾æ¥
            if (url.match(/^BV[a-zA-Z0-9]+$/)) {
                return url;
            }
            const match = url.match(/BV[a-zA-Z0-9]+/);
            return match ? match[0] : null;
        }

        // ä¿å­˜ä½œå“
        function saveWork() {
            const title = document.getElementById('workTitle').value;
            const desc = document.getElementById('workDesc').value;
            const videoUrl = document.getElementById('workVideoUrl').value;
            
            if (!title || !videoUrl) {
                showToast('è¯·å¡«å†™æ ‡é¢˜å’Œè§†é¢‘é“¾æ¥', 'error');
                return;
            }
            
            const bvid = extractBvid(videoUrl);
            if (!bvid) {
                showToast('æ— æ³•è¯†åˆ«è§†é¢‘é“¾æ¥ï¼Œè¯·ä½¿ç”¨Bç«™é“¾æ¥æˆ–BVå·', 'error');
                return;
            }
            
            const work = {
                id: editingWorkId || Date.now(),
                title: title,
                desc: desc,
                videoUrl: videoUrl,
                bvid: bvid,
                image: tempImageData || (editingWorkId ? siteData.works.find(w => w.id === editingWorkId)?.image : '')
            };
            
            if (editingWorkId) {
                const index = siteData.works.findIndex(w => w.id === editingWorkId);
                siteData.works[index] = work;
            } else {
                siteData.works.push(work);
            }
            
            loadWorks();
            closeModal();
            showToast('ä¿å­˜æˆåŠŸ');
        }

        // ç¼–è¾‘ä½œå“
        function editWork(id) {
            const work = siteData.works.find(w => w.id === id);
            if (work) {
                editingWorkId = id;
                document.getElementById('workTitle').value = work.title;
                document.getElementById('workDesc').value = work.desc;
                document.getElementById('workVideoUrl').value = work.videoUrl;
                document.getElementById('imagePreview').innerHTML = work.image ? 
                    `<img src="${work.image}" style="width: 100%; height: 100%; object-fit: cover;">` : 'é¢„è§ˆ';
                tempImageData = work.image;
                openModal('edit');
            }
        }

        // åˆ é™¤ä½œå“
        function deleteWork(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä½œå“å—ï¼Ÿ')) {
                siteData.works = siteData.works.filter(w => w.id !== id);
                loadWorks();
                showToast('å·²åˆ é™¤');
            }
        }

        // æ˜¾ç¤ºæç¤º
        function showToast(msg, type = '') {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.className = 'toast' + (type ? ' ' + type : '');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // ç”Ÿæˆç½‘ç«™ä»£ç 
        function generateSiteCode() {
            // æ›´æ–°æ•°æ®
            siteData.company.name = document.getElementById('companyName').value;
            siteData.company.tagline = document.getElementById('companyTagline').value;
            siteData.company.description = document.getElementById('companyDesc').value;
            siteData.company.stats.years = document.getElementById('statYears').value;
            siteData.company.stats.projects = document.getElementById('statProjects').value;
            siteData.company.stats.likes = document.getElementById('statLikes').value;
            siteData.contact.phone = document.getElementById('contactPhone').value;
            siteData.contact.wechat = document.getElementById('contactWechat').value;
            siteData.contact.email = document.getElementById('contactEmail').value;

            // ç”Ÿæˆä½œå“HTML
            const worksHtml = siteData.works.map((work, index) => `
                <div class="work-item" style="background-image: url('${work.image || ''}');" onclick="openBiliVideo('//player.bilibili.com/player.html?bvid=${work.bvid}&page=1')">
                    <div class="work-info">
                        <h4>${work.desc || work.title}</h4>
                        <p>ç‚¹å‡»æ’­æ”¾ â†’</p>
                    </div>
                </div>
            `).join('\n');

            // å®Œæ•´çš„HTMLæ¨¡æ¿
            const html = `<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${siteData.company.name}</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0a0a0a; --card: #111111; --text: #ffffff;
            --text-secondary: #888888; --accent: #d4a55c; --border: #222222;
        }
        body { font-family: 'Noto Sans SC', sans-serif; background: var(--bg); color: var(--text); }
        
        nav { position: fixed; top: 0; width: 100%; padding: 1.5rem 5%; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: linear-gradient(to bottom, rgba(10,10,10,0.9), transparent); }
        .logo { font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; }
        .logo span { color: var(--accent); }
        .nav-links { display: flex; gap: 2.5rem; list-style: none; }
        .nav-links a { color: var(--text-secondary); text-decoration: none; font-size: 0.9rem; transition: color 0.3s; }
        .nav-links a:hover { color: var(--accent); }
        
        .hero { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: radial-gradient(ellipse at 20% 80%, rgba(212, 165, 92, 0.1) 0%, transparent 50%), var(--bg); }
        .hero-content h1 { font-size: clamp(3rem, 8vw, 6rem); font-weight: 700; letter-spacing: 0.2em; background: linear-gradient(135deg, #fff 0%, #888 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-content .subtitle { font-size: 1.2rem; color: var(--accent); letter-spacing: 0.5em; margin: 1rem 0 2rem; }
        .hero-content p { color: var(--text-secondary); max-width: 600px; margin: 0 auto 3rem; font-weight: 300; }
        .cta-btn { display: inline-block; padding: 1rem 3rem; border: 1px solid var(--accent); color: var(--accent); text-decoration: none; font-size: 0.9rem; letter-spacing: 0.2em; transition: all 0.3s; }
        .cta-btn:hover { background: var(--accent); color: var(--bg); }
        
        .about { padding: 10rem 5%; background: var(--card); }
        .container { max-width: 1200px; margin: 0 auto; }
        .section-title { font-size: 0.75rem; color: var(--accent); letter-spacing: 0.3em; margin-bottom: 1rem; }
        .section-heading { font-size: clamp(2rem, 5vw, 3rem); font-weight: 700; margin-bottom: 3rem; }
        .about-content { display: grid; grid-template-columns: 1fr 1fr; gap: 5rem; align-items: center; }
        .about-text p { color: var(--text-secondary); font-size: 1rem; line-height: 2; margin-bottom: 1.5rem; }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; margin-top: 3rem; }
        .stat-item h3 { font-size: 2.5rem; color: var(--accent); font-weight: 700; }
        .stat-item p { font-size: 0.8rem; color: var(--text-secondary); }
        
        .works { padding: 10rem 5%; }
        .works-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .work-item { aspect-ratio: 16/9; background: var(--card); background-size: cover; background-position: center; border: 1px solid var(--border); position: relative; overflow: hidden; cursor: pointer; transition: all 0.3s; }
        .work-item::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); opacity: 0; transition: opacity 0.3s; }
        .work-item:hover::before { opacity: 1; }
        .work-item:hover { border-color: var(--accent); transform: translateY(-5px); }
        .work-info { position: absolute; bottom: 0; left: 0; right: 0; padding: 1.5rem; transform: translateY(100%); transition: transform 0.3s; }
        .work-item:hover .work-info { transform: translateY(0); }
        .work-info h4 { font-size: 1rem; margin-bottom: 0.3rem; }
        .work-info p { font-size: 0.75rem; color: var(--text-secondary); }
        
        .services { padding: 10rem 5%; background: var(--card); }
        .services-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 2rem; }
        .service-item { padding: 2.5rem; background: var(--bg); border: 1px solid var(--border); }
        .service-number { font-size: 0.75rem; color: var(--accent); margin-bottom: 1rem; }
        .service-item h3 { font-size: 1.1rem; margin-bottom: 1rem; }
        .service-item p { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; }
        
        .contact { padding: 10rem 5%; text-align: center; }
        .contact-content { max-width: 600px; margin: 0 auto; }
        .contact-info { margin-top: 3rem; display: flex; justify-content: center; gap: 4rem; }
        .contact-item h4 { font-size: 0.7rem; color: var(--text-secondary); letter-spacing: 0.2em; margin-bottom: 0.5rem; }
        .contact-item p { font-size: 1rem; }
        
        footer { padding: 3rem 5%; background: var(--card); border-top: 1px solid var(--border); text-align: center; }
        footer p { color: var(--text-secondary); font-size: 0.8rem; }
        
        @media (max-width: 1024px) {
            .about-content { grid-template-columns: 1fr; }
            .works-grid { grid-template-columns: repeat(2, 1fr); }
            .services-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .works-grid, .services-grid { grid-template-columns: 1fr; }
            .stats { grid-template-columns: 1fr; text-align: center; }
            .contact-info { flex-direction: column; gap: 2rem; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">æ¸²æŸ“<span>.</span></div>
        <ul class="nav-links">
            <li><a href="#about">å…³äº</a></li>
            <li><a href="#works">ä½œå“</a></li>
            <li><a href="#services">æœåŠ¡</a></li>
            <li><a href="#contact">è”ç³»</a></li>
        </ul>
    </nav>

    <section class="hero">
        <div class="hero-content">
            <h1>${siteData.company.name.split('æœ‰é™å…¬å¸')[0]}</h1>
            <p class="subtitle">XUANRAN CULTURE</p>
            <p>${siteData.company.tagline}<br>${siteData.company.description.split('ã€‚')[0]}</p>
            <a href="#works" class="cta-btn">æŸ¥çœ‹ä½œå“</a>
        </div>
    </section>

    <section class="about" id="about">
        <div class="container">
            <p class="section-title">ABOUT US</p>
            <h2 class="section-heading">å…³äºæˆ‘ä»¬</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>${siteData.company.description}</p>
                    <div class="stats">
                        <div class="stat-item"><h3>${siteData.company.stats.years}</h3><p>å¹´è¡Œä¸šç»éªŒ</p></div>
                        <div class="stat-item"><h3>${siteData.company.stats.projects}</h3><p>å®Œæˆé¡¹ç›®</p></div>
                        <div class="stat-item"><h3>${siteData.company.stats.likes}</h3><p>è·èµæ”¶è—</p></div>
                    </div>
                </div>
                <div class="about-image" style="aspect-ratio: 4/3; background: var(--card); display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                    [ å›¢é˜Ÿå½¢è±¡ç…§ ]
                </div>
            </div>
        </div>
    </section>

    <section class="works" id="works">
        <div class="container">
            <p class="section-title">SELECTED WORKS</p>
            <h2 class="section-heading">ç²¾é€‰ä½œå“</h2>
            <div class="works-grid">
                ${worksHtml}
            </div>
        </div>
    </section>

    <section class="services" id="services">
        <div class="container">
            <p class="section-title">SERVICES</p>
            <h2 class="section-heading">æœåŠ¡èŒƒå›´</h2>
            <div class="services-grid">
                <div class="service-item"><p class="service-number">01</p><h3>TVC å¹¿å‘Šç‰‡</h3><p>å“ç‰Œç”µè§†å¹¿å‘Šã€ç½‘ç»œå¹¿å‘Šåˆ›æ„æ‹æ‘„</p></div>
                <div class="service-item"><p class="service-number">02</p><h3>å“ç‰Œå®£ä¼ ç‰‡</h3><p>ä¼ä¸šå½¢è±¡ç‰‡ã€äº§å“å®£ä¼ ç‰‡</p></div>
                <div class="service-item"><p class="service-number">03</p><h3>çŸ­è§†é¢‘å†…å®¹</h3><p>ç¤¾äº¤åª’ä½“çŸ­è§†é¢‘ã€ç—…æ¯’è§†é¢‘åˆ›æ„</p></div>
                <div class="service-item"><p class="service-number">04</p><h3>å‰§æƒ…çŸ­ç‰‡</h3><p>æ•…äº‹æ€§å½±åƒåˆ›ä½œï¼Œç”µå½±æ„Ÿå™äº‹é£æ ¼</p></div>
            </div>
        </div>
    </section>

    <section class="contact" id="contact">
        <div class="container">
            <p class="section-title">CONTACT</p>
            <h2 class="section-heading">è”ç³»æˆ‘ä»¬</h2>
            <div class="contact-content">
                <p style="color: var(--text-secondary);">å¦‚æœæ‚¨æœ‰é¡¹ç›®éœ€æ±‚æˆ–åˆä½œæ„å‘<br>æ¬¢è¿éšæ—¶ä¸æˆ‘ä»¬è”ç³»</p>
                <div class="contact-info">
                    <div class="contact-item"><h4>ç”µè¯</h4><p>${siteData.contact.phone}</p></div>
                    ${siteData.contact.wechat ? `<div class="contact-item"><h4>å¾®ä¿¡</h4><p>${siteData.contact.wechat}</p></div>` : ''}
                    ${siteData.contact.email ? `<div class="contact-item"><h4>é‚®ç®±</h4><p>${siteData.contact.email}</p></div>` : ''}
                </div>
            </div>
        </div>
    </section>

    <footer>
        <p>&copy; 2024 ${siteData.company.name} | XUANRAN CULTURE</p>
    </footer>

    <script>
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
            });
        });

        function openBiliVideo(bvid) {
            const overlay = document.createElement('div');
            overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center;';
            
            const closeBtn = document.createElement('button');
            closeBtn.innerHTML = 'âœ•';
            closeBtn.style.cssText = 'position: absolute; top: 30px; right: 40px; background: none; border: 2px solid rgba(255,255,255,0.3); color: #fff; font-size: 24px; cursor: pointer; width: 50px; height: 50px; border-radius: 50%;';
            closeBtn.onclick = () => { document.body.removeChild(overlay); document.body.style.overflow = ''; };
            
            const container = document.createElement('div');
            container.style.cssText = 'width: 90%; max-width: 1200px; aspect-ratio: 16/9;';
            
            const iframe = document.createElement('iframe');
            iframe.src = 'https:' + bvid;
            iframe.style.cssText = 'width: 100%; height: 100%; border: none; border-radius: 8px;';
            iframe.allowFullscreen = true;
            
            container.appendChild(iframe);
            overlay.appendChild(closeBtn);
            overlay.appendChild(container);
            document.body.appendChild(overlay);
            document.body.style.overflow = 'hidden';
        }
    </script>
</body>
</html>`;

            return html;
        }

        // å‘å¸ƒç½‘ç«™
        async function publishSite() {
            const token = document.getElementById('githubToken').value;
            if (!token) {
                showToast('è¯·è¾“å…¥ GitHub Token', 'error');
                return;
            }

            const statusDiv = document.getElementById('publishStatus');
            const logDiv = document.getElementById('publishLog');
            statusDiv.style.display = 'block';
            logDiv.textContent = 'æ­£åœ¨ç”Ÿæˆç½‘ç«™ä»£ç ...\n';

            try {
                // ç”Ÿæˆä»£ç 
                const html = generateSiteCode();
                logDiv.textContent += 'âœ… ç½‘ç«™ä»£ç ç”Ÿæˆå®Œæˆ\n';
                logDiv.textContent += 'æ­£åœ¨æ¨é€åˆ° GitHub...\n';

                // æ¨é€åˆ° GitHub
                const response = await fetch('https://api.github.com/repos/jiang72353093-ai/xuanran-culture/contents/index.html', {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: 'Update website via admin panel',
                        content: btoa(unescape(encodeURIComponent(html))),
                        sha: await getFileSha(token)
                    })
                });

                if (response.ok) {
                    logDiv.textContent += 'âœ… æ¨é€æˆåŠŸï¼\n';
                    logDiv.textContent += 'ğŸ‰ ç½‘ç«™å°†åœ¨ 30-60 ç§’åè‡ªåŠ¨æ›´æ–°\n';
                    logDiv.textContent += 'ğŸŒ è®¿é—®åœ°å€ï¼šhttps://xuanran-culture.vercel.app';
                    showToast('å‘å¸ƒæˆåŠŸï¼');
                } else {
                    const error = await response.json();
                    throw new Error(error.message);
                }
            } catch (err) {
                logDiv.textContent += `âŒ é”™è¯¯ï¼š${err.message}\n`;
                showToast('å‘å¸ƒå¤±è´¥ï¼š' + err.message, 'error');
            }
        }

        // è·å–æ–‡ä»¶ SHA
        async function getFileSha(token) {
            try {
                const response = await fetch('https://api.github.com/repos/jiang72353093-ai/xuanran-culture/contents/index.html', {
                    headers: { 'Authorization': `token ${token}` }
                });
                const data = await response.json();
                return data.sha;
            } catch (e) {
                return null;
            }
        }
    </script>
</body>
</html>
